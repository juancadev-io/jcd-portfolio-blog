---
import FormattedDate from "../../components/FormattedDate.astro";
import Layout from "../../layouts/Layout.astro";
import SocialIcon from "../../components/SocialIcon.astro";
import WorkItem from "../../components/WorkItem.astro";

import GithubIcon from "../../icons/GithubIcon.astro";
import YoutubeIcon from "../../icons/YoutubeIcon.astro";
import LinkedinIcon from "../../icons/LinkedinIcon.astro";
import XIcon from "../../icons/XIcon.astro";

import { getBlogPostsByLang } from "../../content.config";
import { getLangFromUrl, useTranslations } from "../../i18n/utils";
import { PROJECTS, SOCIAL_LINKS, WORK_COMPANIES } from "../../constants";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const latestPosts = (await getBlogPostsByLang(lang)).slice(0, 10);

export async function getStaticPaths() {
  return ["en", "es"].map((lang) => {
    return { params: { lang } };
  });
}
---

<Layout title={t("site.title")} description={t("site.description")} lang={lang}>
  <!-- Hero Section -->
  <section class="container mb-12">
    <h1 class="text-3xl sm:text-4xl md:text-5xl font-bold mb-4 gradient-text">
      {t("home.title")}
    </h1>
    <p class="text-base sm:text-lg text-gray-400 mb-6">{t("home.description")}</p>
    <div class="flex flex-col sm:flex-row items-start sm:items-center gap-3">
      <span class="text-sm sm:text-base font-medium">{t("home.find.me")}:</span>
      <div class="flex gap-3">
        <SocialIcon href={SOCIAL_LINKS.github} name="GitHub">
          <GithubIcon />
        </SocialIcon>
        <SocialIcon href={SOCIAL_LINKS.youtube} name="YouTube">
          <YoutubeIcon />
        </SocialIcon>
        <SocialIcon href={SOCIAL_LINKS.twitter} name="Twitter">
          <XIcon />
        </SocialIcon>
      </div>
    </div>
  </section>
  
  <!-- Work Section -->
  <section class="container mb-12">
    <h2 class="text-2xl sm:text-3xl font-bold mb-6">
      {t("home.work.title")}
    </h2>
    <div class="space-y-4">
      <WorkItem
        name={t("home.work.current.name")}
        href={WORK_COMPANIES.dafiti}
        description={t("home.work.current.description")}
      />
      <WorkItem
        name={t("home.work.previous.name")}
        href={WORK_COMPANIES.bancodeBogota}
        description={t("home.work.previous.description")}
      />
      <WorkItem
        name={t("home.work.last.name")}
        href={WORK_COMPANIES.canastto}
        description={t("home.work.last.description")}
      />
    </div>
    <div class="flex items-center mt-6 gap-2">
      <a 
        href={SOCIAL_LINKS.linkedin} 
        class="text-primary hover:text-secondary font-medium transition-colors duration-200 underline" 
        target="_blank"
      >
        {t("home.work.more")}
      </a>
      <SocialIcon href={SOCIAL_LINKS.linkedin} name="LinkedIn">
        <LinkedinIcon />
      </SocialIcon>
    </div>
  </section>

  <!-- Projects Section -->
  <section class="container mb-12">
    <h2 class="text-2xl sm:text-3xl font-bold mb-6">
      {t("home.projects.title")}
    </h2>
    <div class="space-y-4">
      <WorkItem
        name={t("home.projects.signature.name")}
        href={PROJECTS.signatureGenerator.live}
        descriptionHtml={t(
          "home.projects.signature.description",
          `<a href="${PROJECTS.signatureGenerator.repo}" class="text-primary hover:text-secondary underline" target="_blank" rel="noopener noreferrer">GitHub</a>`
        )}
      />
    </div>
  </section>
  
  <!-- Latest Posts Section -->
  <section class="container">
    <h2 class="text-2xl sm:text-3xl font-bold mb-6">{t("home.latest.title")}</h2>
    <ol class="space-y-3">
      {
        latestPosts.map((post) => (
          <li class="flex flex-col sm:flex-row pb-3 gap-2 sm:gap-3 sm:items-center border-l-2 border-transparent hover:border-primary pl-3 transition-all duration-200">
            <p class="text-xs sm:text-sm text-gray-400 min-w-25">
              {post.data.pubDate ? (
                <FormattedDate date={post.data.pubDate} />
              ) : (
                t("home.latest.noDate")
              )}
            </p>
            <a
              class="font-semibold text-gray-100 hover:text-primary transition-colors duration-200"
              href={`/${lang}/blog/${post.blog_slug}`}
            >
              {post.data.title}
            </a>
          </li>
        ))
      }
    </ol>
  </section>
</Layout>
